import{i as h,a as g,f as y}from"./BzwGfqBb.js";const m=document.getElementById("filemanager"),p=document.getElementById("loading"),o=document.getElementById("folders"),a=document.getElementById("folders"),i={folder:!1,file:!1};let t=null,E=localStorage.getItem("layout");m.classList.add(E??"card");function s(){!i.folder||!i.file||(o.children.length<1&&a.children.length<1&&document.getElementById("empty").classList.remove("hidden"),p.classList.add("hidden"),m.classList.remove("hidden"))}function f(e){let r=25*e;http.get("/u/folders",{params:{offset:r,trash:!0}}).then(({data:n})=>{if(n.items.forEach(l=>{o.appendChild(g(l,"label",!1))}),o.nextElementSibling.role=="alert"&&o.nextElementSibling.remove(),r+25<n.total){const l=document.createElement("button");l.innerText="Show more",l.classList.add("text-center","text-sm","w-full"),l.onclick=c=>{c.currentTarget.replaceWith(loadingElement()),f(++e)},o.after(l)}i.folder=!0,s()}).catch(n=>errorHandler(n,"007"))}f(0);function u(e){let r=25*e;function n(){window.innerHeight+window.scrollY>=document.body.offsetHeight&&(window.removeEventListener("scroll",n),a.after(loadingElement()),u(++e))}http.get("/u/files",{params:{offset:r,trash:!0}}).then(({data:l})=>{l.items.forEach(c=>{a.appendChild(y(c))}),a.nextElementSibling.role=="alert"&&a.nextElementSibling.remove(),r+25<l.total&&window.addEventListener("scroll",n),i.file=!0,s()}).catch(l=>errorHandler(l,"006"))}u(0);h(["layout"]);const d=e=>{document.getElementById("tools").querySelectorAll("button").forEach(n=>{n.disabled=!e})};document.body.addEventListener("click",e=>{if(e.target.name=="item")t={key:e.target.value,element:e.target.parentElement,type:e.target.dataset.type,name:e.target.dataset.name},t.type=="file"&&(t.ext=e.target.dataset.ext),d(!0);else{if(e.target.closest("#tools")||e.target.closest(".modal"))return;t&&(document.querySelector('[name="item"]:checked').checked=!1,d(!1),t=null)}});document.getElementById("tool-restore").addEventListener("click",()=>{http.post(`/u/trash/${t.key}`,{type:t.type}).then(()=>{toast("File has been restored."),t.element.remove(),t=null,d(!1),s()}).catch(e=>errorHandler(e,"010"))});document.getElementById("tool-delete").addEventListener("click",()=>{http.delete(`/u/trash/${t.key}`,{params:{type:t.type}}).then(()=>{toast("File has been deleted."),t.element.remove(),t=null,d(!1),s()}).catch(e=>errorHandler(null,"011"))});document.getElementById("tool-clear").addEventListener("click",()=>{http.delete("/u/trash").then(()=>{toast("Trash has been cleaned up."),a.innerHTML="",o.innerHTML="",t=null,d(!1),s()}).catch(e=>errorHandler(null,"012"))});
