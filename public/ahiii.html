<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tracking</title>
    <link href="https://link4sub.com/fontend/stu/css/app.css?v=1747217212" rel="stylesheet">
</head>

<body>
    <h1>Tracking</h1>
    <main>
        <div class="stu-container" id="stuC">
            <div class="note">Link4Sub.com - Tạo liên kết như thế này? Có ngay 100$ hằng ngày!. <a
                    href="https://link4sub.com/auth/register" target="__blank">(Đăng ký tài khoản)</a></div>
            <div class="stu-box-wrap s1">
                <div class="t">
                    <h2 class="t-title">Unlock Link (1/1)</h2>
                    <h3 class="t-s-title">Hoàn thành các bước để mở khóa link, bạn chỉ mất 30 giây.</h3>
                </div>
                <div class="i"></div>
                <div class="b">
                    <a class="stu-btn yt" data-id="yt1" href="https://www.youtube.com/@JinxMCz"
                        data-name="Subscribe on YouTube" target="_blank" rel="noopener noreferrer">
                        <svg fill="currentColor" viewBox="0 0 576 512">
                            <path
                                d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z">
                            </path>
                        </svg>
                        <span>Subscribe on YouTube</span>
                        <i class="lft-i"><svg fill="currentColor" viewBox="0 0 448 512">
                                <defs>
                                    <style>
                                        .fa-secondary {
                                            opacity: .4
                                        }
                                    </style>
                                </defs>
                                <path class="fa-primary"
                                    d="M224 480c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L370.8 256L201.4 86.63c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l192 192c12.5 12.5 12.5 32.75 0 45.25l-192 192C240.4 476.9 232.2 480 224 480z">
                                </path>
                                <path class="fa-secondary"
                                    d="M32 480c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L178.8 256L9.375 86.63c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l192 192c12.5 12.5 12.5 32.75 0 45.25l-192 192C48.38 476.9 40.19 480 32 480z">
                                </path>
                            </svg></i>
                    </a>
                    <a class="stu-btn yt" data-id="yt2" href="https://www.youtube.com/@JinxMCz"
                        data-name="Subscribe on YouTube" target="_blank" rel="noopener noreferrer">
                        <svg fill="currentColor" viewBox="0 0 576 512">
                            <path
                                d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z">
                            </path>
                        </svg>
                        <span>Subscribe on YouTube</span>
                        <i class="lft-i"><svg fill="currentColor" viewBox="0 0 448 512">
                                <defs>
                                    <style>
                                        .fa-secondary {
                                            opacity: .4
                                        }
                                    </style>
                                </defs>
                                <path class="fa-primary"
                                    d="M224 480c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L370.8 256L201.4 86.63c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l192 192c12.5 12.5 12.5 32.75 0 45.25l-192 192C240.4 476.9 232.2 480 224 480z">
                                </path>
                                <path class="fa-secondary"
                                    d="M32 480c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L178.8 256L9.375 86.63c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l192 192c12.5 12.5 12.5 32.75 0 45.25l-192 192C48.38 476.9 40.19 480 32 480z">
                                </path>
                            </svg></i>
                    </a>
                    <a class="stu-btn ytl" data-id="ytl1" href="https://youtu.be/geZvXfkByTQ?si=T7yh9ukpk0N4WIkf"
                        data-name="Like on YouTube" target="_blank" rel="noopener noreferrer">
                        <svg fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M2 8.996h3v12H2a1 1 0 0 1-1-1v-10a1 1 0 0 1 1-1Zm5.293-1.293 6.4-6.4a.5.5 0 0 1 .654-.047l.853.64a1.5 1.5 0 0 1 .553 1.57L14.6 7.996H21a2 2 0 0 1 2 2V12.1a2 2 0 0 1-.15.762l-3.095 7.515a1 1 0 0 1-.925.62H8a1 1 0 0 1-1-1V8.41a1 1 0 0 1 .293-.707Z">
                            </path>
                        </svg>
                        <span>Like on YouTube</span>
                        <i class="lft-i"><svg fill="currentColor" viewBox="0 0 448 512">
                                <defs>
                                    <style>
                                        .fa-secondary {
                                            opacity: .4
                                        }
                                    </style>
                                </defs>
                                <path class="fa-primary"
                                    d="M224 480c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L370.8 256L201.4 86.63c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l192 192c12.5 12.5 12.5 32.75 0 45.25l-192 192C240.4 476.9 232.2 480 224 480z">
                                </path>
                                <path class="fa-secondary"
                                    d="M32 480c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L178.8 256L9.375 86.63c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l192 192c12.5 12.5 12.5 32.75 0 45.25l-192 192C48.38 476.9 40.19 480 32 480z">
                                </path>
                            </svg></i>
                    </a>
                    <a class="stu-btn ytc" data-id="ytc1" href="https://youtu.be/geZvXfkByTQ?si=T7yh9ukpk0N4WIkf"
                        data-name="Comment on YouTube" target="_blank" rel="noopener noreferrer">
                        <svg fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path
                                d="M2 6a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3h-4.172a1 1 0 0 0-.707.293l-1.867 1.867C11.054 22.361 9 21.51 9 19.812A.812.812 0 0 0 8.188 19H5a3 3 0 0 1-3-3V6Zm5 0a1 1 0 0 0 0 2h10a1 1 0 1 0 0-2H7Zm0 4a1 1 0 1 0 0 2h10a1 1 0 1 0 0-2H7Zm0 4a1 1 0 1 0 0 2h4a1 1 0 1 0 0-2H7Z">
                            </path>
                        </svg>
                        <span>Comment on YouTube</span>
                        <i class="lft-i"><svg fill="currentColor" viewBox="0 0 448 512">
                                <defs>
                                    <style>
                                        .fa-secondary {
                                            opacity: .4
                                        }
                                    </style>
                                </defs>
                                <path class="fa-primary"
                                    d="M224 480c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L370.8 256L201.4 86.63c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l192 192c12.5 12.5 12.5 32.75 0 45.25l-192 192C240.4 476.9 232.2 480 224 480z">
                                </path>
                                <path class="fa-secondary"
                                    d="M32 480c-8.188 0-16.38-3.125-22.62-9.375c-12.5-12.5-12.5-32.75 0-45.25L178.8 256L9.375 86.63c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0l192 192c12.5 12.5 12.5 32.75 0 45.25l-192 192C48.38 476.9 40.19 480 32 480z">
                                </path>
                            </svg></i>
                    </a>
                </div>
                <div class="p" id="pg">
                    <div>Unlock Progress <span id="prog01">0</span>/<span>4</span></div>
                    <div class="stu-progs">
                        <div id="stuBar" class="" style="width:0%"></div>
                    </div>
                </div>
                <div class="d ">
                    <div class="cl">
                        <a class="stu-btn lock last-btn lnk" data-href="aHR0cHMlM0ElMkYlMkZ3d3cuZmFjZWJvb2suY29tJTJG"
                            target="_blank" rel="noopener noreferrer">
                            <svg fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path
                                    d="M12 2C9.243 2 7 4.243 7 7v3H6a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2h-1V7c0-2.757-2.243-5-5-5ZM9 7c0-1.654 1.346-3 3-3s3 1.346 3 3v3H9V7Zm4 10.723V20h-2v-2.277a1.994 1.994 0 0 1 1.454-3.672 2 2 0 0 1 1.277 2.945 1.99 1.99 0 0 1-.731.727Z">
                                </path>
                            </svg>
                            <span>Continue</span>
                            <i class="lft-i"><svg fill="currentColor" viewBox="0 0 640 512">
                                    <defs>
                                        <style>
                                            .fa-secondary {
                                                opacity: .4
                                            }
                                        </style>
                                    </defs>
                                    <path class="fa-primary"
                                        d="M41.41 270.7l133.3-133.3C202.3 109.8 238.5 96 274.6 96s72.36 13.8 99.96 41.41C402.2 165 415.1 201.2 416 237.4c.0004 36.18-13.8 72.36-41.41 99.97l-14.18 14.18c-18.78-1.197-36.33-8.753-49.75-22.18c-3.154-3.154-5.855-6.626-8.382-10.19l27.06-27.06c14.61-14.61 22.66-34.04 22.66-54.71s-8.049-40.1-22.66-54.71C314.7 168 295.3 160 274.6 160C253.1 160 234.5 168 219.9 182.7L86.66 315.9c-14.62 14.61-22.66 34.04-22.66 54.71s8.047 40.1 22.66 54.71C101.3 439.1 120.7 448 141.4 448c20.67 0 40.1-8.047 54.71-22.66l60.59-60.59c2.779 3.355 5.584 6.7 8.731 9.846c12.72 12.72 27.39 22.17 42.91 29.02l-66.98 66.98C213.7 498.2 177.6 512 141.4 512c-36.18 0-72.36-13.8-99.97-41.41C-13.8 415.4-13.8 325.9 41.41 270.7z">
                                    </path>
                                    <path class="fa-secondary"
                                        d="M598.6 241.3l-133.3 133.3C437.7 402.2 401.6 416 365.4 416s-72.36-13.8-99.96-41.41c-26.63-26.63-40.42-61.25-41.36-96.15C223 241 236.8 203.2 265.4 174.7L279.6 160.5c18.78 1.197 36.33 8.753 49.75 22.18c3.154 3.154 5.854 6.626 8.382 10.19L310.7 219.9c-14.61 14.61-22.66 34.04-22.66 54.71s8.049 40.1 22.66 54.71C325.3 343.1 344.7 352 365.4 352c20.67 0 40.1-8.049 54.71-22.66l133.3-133.3c14.62-14.61 22.66-34.04 22.66-54.71S567.1 101.3 553.3 86.66C538.7 72.05 519.3 64 498.6 64c-20.67 0-40.1 8.047-54.71 22.66l-60.59 60.59c-2.779-3.355-5.584-6.7-8.73-9.846c-12.72-12.72-27.39-22.17-42.91-29.02l66.98-66.98C426.3 13.8 462.4 0 498.6 0c36.18 0 72.36 13.8 99.96 41.41c27.11 27.11 40.9 62.48 41.39 98C640.5 176.2 626.7 213.2 598.6 241.3z">
                                    </path>
                                </svg></i>
                        </a>
                    </div>
                    <div class="cp"></div>
                </div>
                <div class="f">
                    <div class="ft">
                        <span>Created with </span>
                        <img src="https://link4sub.com/images/favicon.png">
                        <a href="https://link4sub.com/"> Link4Sub</a>
                    </div>
                </div>
            </div>
        </div>
        <div>Tracking:
            <div id="tracking"></div>
        </div>
    </main>
    <script>
        const yxx = {
            f: {
                dcc: "",
                dcl: "",
                cpn: "",
                gvd: "",
                grr: "",
                ct: "1",
                diit: [],
                dit: [],
                cmn: [],
                ua: "",
                webdriver: "",
                has_touch: "",
                is_mobile_ua: "",
                first_click_delay: null,
                mousemove_count: 0,
                scroll_count: 0,
                keypress_count: 0,
                plugins: 0,
                canvas_fp: "",
                tz_offset: "",
                lang: "",
                screen: "",
                // New attributes
                mouse_precision: [],
                mouse_patterns: [],
                touch_patterns: [],
                automation_flags: {},
                audio_fp: "",
                fonts: [],
                perf_timing: {},
                storage_available: {},
                js_errors: [],
                browser_lies: [],
                permissions: {},
                interaction_quality: 0
            },

            init: function () {
                // ...existing code...
                // motion/orientation
                window.addEventListener('deviceorientation', function (event) {
                    if (!event.alpha) return;
                    var v = [event.alpha.toFixed(4), event.beta.toFixed(4), event.gamma.toFixed(4)].join(",");
                    if (yxx.f.diit.length < 5) yxx.f.diit.push(v);
                }, false);

                window.addEventListener('devicemotion', function (event) {
                    var acc = event.accelerationIncludingGravity;
                    var v = [acc.x.toFixed(4), acc.y.toFixed(4), acc.z.toFixed(4)].join(",");
                    if (yxx.f.dit.length < 5) yxx.f.dit.push(v);
                }, false);

                window.addEventListener('touchstart', function (ev) {
                    var clientX = ev.touches[0].clientX;
                    var clientY = ev.touches[0].clientY;
                    var v = [clientX, clientY].join("_");
                    if (yxx.f.cmn.length < 5) yxx.f.cmn.push(v);

                    // Record touch timing patterns
                    yxx.recordTouchPattern(ev);
                }, false);

                // Enhanced interaction tracking
                let lastMouseX = 0, lastMouseY = 0, lastMouseTime = Date.now();
                document.addEventListener('mousemove', (e) => {
                    yxx.f.mousemove_count++;

                    // Track mouse precision and movement patterns
                    const now = Date.now();
                    const timeGap = now - lastMouseTime;
                    if (lastMouseX !== 0 && timeGap < 500) {
                        // Calculate how straight the line is (bots often move in too-perfect lines)
                        const distance = Math.sqrt(Math.pow(e.clientX - lastMouseX, 2) +
                            Math.pow(e.clientY - lastMouseY, 2));
                        const speed = distance / timeGap;

                        if (yxx.f.mouse_precision.length < 20) {
                            yxx.f.mouse_precision.push(speed.toFixed(4));
                        }

                        // Record pattern sample
                        if (yxx.f.mouse_patterns.length < 10) {
                            yxx.f.mouse_patterns.push(`${(e.clientX - lastMouseX).toFixed(2)},${(e.clientY - lastMouseY).toFixed(2)},${timeGap}`);
                        }
                    }

                    lastMouseX = e.clientX;
                    lastMouseY = e.clientY;
                    lastMouseTime = now;
                });

                document.addEventListener('scroll', () => yxx.f.scroll_count++);
                document.addEventListener('keydown', (e) => {
                    yxx.f.keypress_count++;
                    // Detect unnatural keyboard patterns
                    if (yxx.f.last_key_time) {
                        const gap = Date.now() - yxx.f.last_key_time;
                        if (gap < 10) yxx.f.automation_flags.fast_typing = true;
                    }
                    yxx.f.last_key_time = Date.now();
                });

                // first click delay
                const _start_time = Date.now();
                document.addEventListener('click', (e) => {
                    if (!yxx.f.first_click_delay) {
                        yxx.f.first_click_delay = Date.now() - _start_time;
                    }

                    // Too precise clicks might indicate automation
                    if (e.clientX % 1 === 0 && e.clientY % 1 === 0) {
                        if (!yxx.f.automation_flags.precise_clicks) {
                            yxx.f.automation_flags.precise_clicks = 0;
                        }
                        yxx.f.automation_flags.precise_clicks++;
                    }
                });

                // Check for JS error patterns
                window.addEventListener('error', (e) => {
                    if (yxx.f.js_errors.length < 3) {
                        yxx.f.js_errors.push(e.message.substring(0, 50));
                    }
                });

                // Track performance timing
                window.addEventListener('load', () => {
                    setTimeout(() => {
                        const timing = performance.timing;
                        yxx.f.perf_timing = {
                            load: timing.loadEventEnd - timing.navigationStart,
                            dom: timing.domComplete - timing.domLoading,
                            net: timing.responseEnd - timing.requestStart
                        };
                    }, 0);
                });
            },

            recordTouchPattern: function (ev) {
                if (yxx.f.last_touch_time) {
                    const gap = Date.now() - yxx.f.last_touch_time;
                    if (yxx.f.touch_patterns.length < 5) {
                        const touch = ev.touches[0];
                        yxx.f.touch_patterns.push(`${touch.clientX.toFixed(1)},${touch.clientY.toFixed(1)},${gap}`);
                    }
                }
                yxx.f.last_touch_time = Date.now();
            },

            battery: async function () {
                try {
                    const battery = await navigator.getBattery();

                    yxx.f.dcc = battery.charging ? "yes" : "no";
                    yxx.f.dcl = (battery.level * 100).toFixed(0) + "%";

                    // Khởi tạo nếu chưa có
                    yxx.f.browser_lies = yxx.f.browser_lies || [];

                    // Phát hiện bất thường đơn giản nhất
                    if (
                        yxx.f.is_mobile_ua === "yes" &&
                        battery.level === 1 &&
                        battery.charging === true
                    ) {
                        yxx.f.browser_lies.push("battery_emulator");
                    }

                } catch (e) {
                    console.warn("Battery info not available.");
                    yxx.f.dcc = "unsupported";
                    yxx.f.dcl = "unsupported";
                }
            },

            gpu: function () {
                // ...existing code...
                try {
                    var canvas = document.createElement('canvas');
                    var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                    var debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                    yxx.f.gvd = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);
                    yxx.f.grr = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
                    yxx.f.cpn = navigator.hardwareConcurrency;

                    // Check for VM/emulator standard GPUs
                    const gpuLower = yxx.f.grr.toLowerCase();
                    if (gpuLower.includes('swiftshader') ||
                        gpuLower.includes('llvmpipe') ||
                        gpuLower.includes('virtualbox')) {
                        yxx.f.browser_lies.push("vm_gpu");
                    }
                } catch (e) {
                    console.warn("GPU info not available.");
                    yxx.f.browser_lies.push("gpu_blocked");
                }
            },

            getConnection: function () {
                // ...existing code...
                try {
                    if (navigator.connection && navigator.connection.type) {
                        yxx.f.ct = navigator.connection.type === "cellular" ? "2" : "3";
                    }

                    // Additional network info
                    if (navigator.connection) {
                        const conn = navigator.connection;
                        if (conn.downlink) yxx.f.network_speed = conn.downlink + "Mbps";
                        if (conn.effectiveType) yxx.f.network_type = conn.effectiveType;
                        if (conn.rtt) yxx.f.network_rtt = conn.rtt + "ms";
                    }
                } catch (e) { }
            },

            checkPermissions: async function () {
                try {
                    const permissionsToCheck = ['notifications', 'geolocation', 'camera', 'microphone'];
                    for (const permission of permissionsToCheck) {
                        try {
                            const status = await navigator.permissions.query({ name: permission });
                            yxx.f.permissions[permission] = status.state;
                        } catch (e) {
                            yxx.f.permissions[permission] = "error";
                        }
                    }
                } catch (e) {
                    console.warn("Permissions API not available");
                }
            },

            checkStorage: function () {
                // Check available storages
                try {
                    yxx.f.storage_available.localStorage = !!window.localStorage;
                    yxx.f.storage_available.sessionStorage = !!window.sessionStorage;
                    yxx.f.storage_available.indexedDB = !!window.indexedDB;

                    // Test actual write capability
                    if (window.localStorage) {
                        try {
                            localStorage.setItem('__test__', '1');
                            localStorage.removeItem('__test__');
                            yxx.f.storage_available.localStorageWrite = true;
                        } catch (e) {
                            yxx.f.storage_available.localStorageWrite = false;
                        }
                    }
                } catch (e) {
                    yxx.f.storage_available.error = true;
                }
            },

            checkFonts: function () {
                // Probe for common fonts to detect OS
                const fontList = [
                    'Arial', 'Courier New', 'Georgia', 'Times New Roman', 'Verdana',
                    'Helvetica', 'Tahoma', 'Trebuchet MS', 'Segoe UI', 'Roboto',
                    'San Francisco', 'Ubuntu', 'Droid Sans', 'Apple Color Emoji'
                ];

                const baseFonts = ['monospace', 'sans-serif', 'serif'];
                const testString = "mmmmmmmmmmlli";
                const testSize = '72px';
                let d = document.createElement("div");

                d.style.cssText = "position: absolute; left: -9999px; visibility: hidden; display: block !important";
                document.body.appendChild(d);

                const defaultWidth = {};
                const defaultHeight = {};

                // Get width of text in default fonts
                for (let i = 0; i < baseFonts.length; i++) {
                    d.style.fontFamily = baseFonts[i];
                    d.innerHTML = testString;
                    defaultWidth[baseFonts[i]] = d.clientWidth;
                    defaultHeight[baseFonts[i]] = d.clientHeight;
                }

                const detected = [];
                for (let i = 0; i < fontList.length; i++) {
                    let match = false;
                    for (let j = 0; j < baseFonts.length; j++) {
                        d.style.fontFamily = fontList[i] + ',' + baseFonts[j];
                        d.innerHTML = testString;
                        if (d.clientWidth !== defaultWidth[baseFonts[j]] ||
                            d.clientHeight !== defaultHeight[baseFonts[j]]) {
                            match = true;
                            break;
                        }
                    }
                    if (match) detected.push(fontList[i]);
                    if (detected.length >= 3) break;
                }

                document.body.removeChild(d);
                yxx.f.fonts = detected;
            },

            audioFingerprint: function () {
                try {
                    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                    const analyser = audioCtx.createAnalyser();
                    const oscillator = audioCtx.createOscillator();
                    const dynamicsCompressor = audioCtx.createDynamicsCompressor();

                    // Set properties that will affect the audio fingerprint
                    oscillator.type = 'triangle';
                    oscillator.frequency.setValueAtTime(10000, audioCtx.currentTime);
                    dynamicsCompressor.threshold.setValueAtTime(-50, audioCtx.currentTime);
                    dynamicsCompressor.knee.setValueAtTime(40, audioCtx.currentTime);
                    dynamicsCompressor.ratio.setValueAtTime(12, audioCtx.currentTime);
                    dynamicsCompressor.attack.setValueAtTime(0, audioCtx.currentTime);
                    dynamicsCompressor.release.setValueAtTime(0.25, audioCtx.currentTime);

                    oscillator.connect(dynamicsCompressor);
                    dynamicsCompressor.connect(analyser);
                    analyser.connect(audioCtx.destination);

                    oscillator.start(0);

                    const dataArray = new Uint8Array(analyser.frequencyBinCount);
                    analyser.getByteFrequencyData(dataArray);

                    // Get a condensed fingerprint from the audio data
                    const fingerprint = dataArray.slice(0, 15).reduce((acc, val) => acc + val, 0);
                    yxx.f.audio_fp = fingerprint.toString();

                    // Clean up
                    oscillator.stop();
                    oscillator.disconnect();
                    dynamicsCompressor.disconnect();
                    analyser.disconnect();
                    audioCtx.close();
                } catch (e) {
                    yxx.f.audio_fp = "error";
                    if (e.message && e.message.includes("user gesture")) {
                        yxx.f.audio_fp = "requires_interaction";
                    }
                }
            },

            fingerprint: function () {
                // ...existing code...
                try {
                    yxx.f.ua = navigator.userAgent;
                    yxx.f.webdriver = navigator.webdriver ? "yes" : "no";
                    yxx.f.has_touch = 'ontouchstart' in window ? "yes" : "no";
                    yxx.f.is_mobile_ua = /android|iphone|ipad|ipod/i.test(navigator.userAgent) ? "yes" : "no";
                    yxx.f.plugins = navigator.plugins.length;
                    yxx.f.tz_offset = new Date().getTimezoneOffset();
                    yxx.f.lang = navigator.language;
                    yxx.f.screen = `${screen.width}x${screen.height}`;

                    // Additional browser fingerprinting
                    yxx.f.memory = navigator.deviceMemory || 0;
                    yxx.f.platform = navigator.platform;
                    yxx.f.doNotTrack = 1;

                    // Check for headless browser properties
                    function detectAutomation() {
                        const flags = {
                            webdriver: !!navigator.webdriver,
                            chrome: /\b(Chrome|Edg|Brave|OPR)\b/i.test(navigator.userAgent),
                            headless: false
                        };

                        // ── phán headless ────────────────────────────
                        // 1) Nếu webdriver bật → chắc chắn là automation
                        if (flags.webdriver) {
                            flags.headless = true;
                            return flags;
                        }

                        // 2) Với Blink (Chrome/Edge/Brave…) dùng bộ ba “dễ kiểm”:
                        //    • navigator.plugins.length == 0           (headless ~ không load plugin)
                        //    • navigator.languages  undefined/empty    (headless thường giấu ngôn ngữ)
                        //    • màn hình vô lý (screen.width==0)        (bị ảo hoá)
                        if (flags.chrome) {
                            const noPlugins = navigator.plugins.length === 0;
                            const noLanguages = !navigator.languages || navigator.languages.length === 0;
                            const weirdScreen = screen.width === 0 || screen.height === 0;

                            flags.headless = (noPlugins && noLanguages) || weirdScreen;
                        }
                        // 3) Với Safari/Firefox: chỉ coi headless khi webdriver=true
                        return flags;
                    }

                    yxx.f.automation_flags = detectAutomation();


                    // Check navigator consistency
                    if (navigator.userAgent.indexOf('Chrome') > -1 && !window.chrome) {
                        yxx.f.browser_lies.push("fake_chrome");
                    }

                    // Mobile/touch mismatch detection
                    if ((yxx.f.is_mobile_ua === "yes" && yxx.f.has_touch === "no") ||
                        (yxx.f.is_mobile_ua === "no" && yxx.f.has_touch === "yes" && !yxx.isTablet())) {
                        yxx.f.browser_lies.push("mobile_touch_mismatch");
                    }

                    // Additional language detection
                    yxx.f.all_langs = navigator.languages ? navigator.languages.join(',') : '';
                } catch (e) { }

                try {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    ctx.textBaseline = "top";
                    ctx.font = "14px Arial";
                    ctx.fillText("BOT-DETECTOR", 2, 2);
                    yxx.f.canvas_fp = canvas.toDataURL().substr(0, 100);

                    // Add additional complex canvas operations to detect headless browsers
                    canvas.width = 240;
                    canvas.height = 60;
                    ctx.textBaseline = "alphabetic";
                    ctx.fillStyle = "#f60";
                    ctx.fillRect(100, 1, 62, 20);
                    ctx.fillStyle = "#069";
                    ctx.font = "18pt Arial";
                    ctx.fillText("!@#$%^&*()", 2, 40);
                    ctx.fillStyle = "rgba(102, 204, 0, 0.7)";
                    ctx.font = "18pt Arial";
                    ctx.fillText("Advanced Bot Detection", 4, 45);

                    // The full fingerprint is too long, so get a hash of it
                    const extendedFP = canvas.toDataURL();
                    yxx.f.canvas_fp_full = yxx.simpleHash(extendedFP);
                } catch (e) {
                    yxx.f.canvas_fp = "error";
                }
            },

            isTablet: function () {
                return /ipad|tablet/i.test(navigator.userAgent) ||
                    (navigator.userAgent.includes('Macintosh') && 'ontouchend' in document);
            },

            simpleHash: function (str) {
                let hash = 0;
                for (let i = 0; i < str.length; i++) {
                    const char = str.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash; // Convert to 32bit integer
                }
                return Math.abs(hash).toString(36);
            },

            calculateInteractionQuality: function () {
                let score = 0;

                // MOBILE-FOCUSED SCORING

                // 👆 Touch interactions (critical for mobile)
                if (yxx.f.touch_patterns && yxx.f.touch_patterns.length > 0) {
                    // More points for varied touch patterns
                    score += Math.min(35, yxx.f.touch_patterns.length * 7);
                }

                // 🧭 Scrolling (very common on mobile)
                if (yxx.f.scroll_count > 0) {
                    // More scrolling = more authentic
                    score += Math.min(25, yxx.f.scroll_count * 2);
                }

                // 📱 Device motion/orientation (unique to real mobile devices)
                if (yxx.f.diit.length > 0 || yxx.f.dit.length > 0) {
                    score += 15;
                }

                // ⏳ Reasonable click/tap delay (bots often click too quickly)
                const tapDelay = yxx.f.first_click_delay || 0;
                if (tapDelay > 500 && tapDelay < 60000) {
                    score += 15;
                } else if (tapDelay > 100) {
                    score += 5; // Some legitimate fast taps
                }

                // 🕐 Time spent on page
                if (yxx.f.time_on_page > 5000) {
                    score += 10;
                }

                // 📊 Consistency checks

                // Check if touch is reported for mobile UA (inconsistency = bot)
                if (yxx.f.is_mobile_ua === "yes" && yxx.f.has_touch === "yes") {
                    score += 5;
                }

                // Check for automation flags
                if (yxx.f.automation_flags &&
                    (!yxx.f.automation_flags.headless && !yxx.f.automation_flags.webdriver)) {
                    score += 10;
                }

                // No browser inconsistencies
                if (!yxx.f.browser_lies || yxx.f.browser_lies.length === 0) {
                    score += 10;
                }

                // Mouse movements are less important but still valid on some mobile
                if (yxx.f.mousemove_count > 5) {
                    score += 5;
                }

                // 📱 Battery info available (common on real devices)
                if (yxx.f.dcc && yxx.f.dcl) {
                    score += 5;
                }

                // Limit the maximum score to 100
                yxx.f.interaction_quality = Math.min(100, score);
            },

            start: async function () {
                // ...existing code...
                try {
                    yxx.init();
                    yxx.fingerprint();
                    yxx.gpu();
                    yxx.getConnection();
                    yxx.checkStorage();
                    yxx.audioFingerprint();

                    // Add slight delay to collect more data
                    await new Promise(resolve => setTimeout(resolve, 300));

                    await yxx.battery();
                    await yxx.checkPermissions();

                    // These require the body to be loaded
                    if (document.body) {
                        yxx.checkFonts();
                    } else {
                        window.addEventListener('DOMContentLoaded', () => {
                            yxx.checkFonts();
                        });
                    }

                    console.log("👉 YXX BOT TRACK:", yxx.get());

                } catch (err) {
                    console.error("yxx error:", err);
                    yxx.f.js_errors.push("init:" + err.message.substring(0, 50));
                }
            },

            get: function () {
                // Calculate final interaction quality score
                yxx.calculateInteractionQuality();

                var p = [];

                for (var e in yxx.f) {
                    if (!yxx.f.hasOwnProperty(e)) continue;
                    var val = Array.isArray(yxx.f[e]) ? yxx.f[e].join(";") :
                        (typeof yxx.f[e] === 'object' ? JSON.stringify(yxx.f[e]) : yxx.f[e]);
                    p.push(e + "=" + (val));
                }

                return p.join("&");
            },
            getData: function () {
                return yxx.f;
            },
        };

        try {
            if (document.querySelectorAll('.stu-box-wrap>.d>.cl>.stu-btn.last-btn').length()) {
                const startPromise = yxx.start();
            }
        } catch (e) {}
startPromise.then(() => {
    navigator.sendBeacon(
        location.origin + '/link4sub_dz',
        JSON.stringify([...yxx.getData(), ...{
            'user_id': STATE.data.info.userId,
            'link_id': STATE.data.info.linkId
        }]
    ));

});
        (async () => {
            await yxx.start();
            setTimeout(() => {
                navigator.sendBeacon(location.origin + '/link4sub_dz', JSON.stringify([...yxx.getData(), ...['user_id=12345']]));


                document.getElementById('tracking').innerText = JSON.stringify(yxx.getData(), null, 2);
            }, 10000);
        })();
    </script>

    <!-- <script src="./track.js"></script> -->
</body>

</html>
